from collections import defaultdict
from typing import List

#https://leetcode.com/problems/count-complete-subarrays-in-an-array/description/?envType=problem-list-v2&envId=sliding-window
class Solution:
    def countCompleteSubarraysTLE(self, nums: List[int]) -> int:
        s = len(set(nums)) #TLE
        count = 0
        for i in range(len(nums)):
            ss = set()
            for y in range(i, len(nums)):
                ss.add(nums[y])
                if len(ss) == s:
                    count += 1
        return count   
    
    def countCompleteSubarraysTwo(self, nums: List[int]) -> int:
        s = len(set(nums))
        count = 0
        for i in range(len(nums)):
            subarray = nums[i:]
            setS = set(subarray)
            newS = set()
            l, r = 0, len(subarray)
            if len(setS) >= s:
                while l < r or len(subarray) < s:
                    newS.add(subarray[l])
                    l += 1
                    if len(newS) >= s:
                        count += 1
        return count
    
    def countCompleteSubarrays(self, nums: List[int]) -> int:
        s = len(set(nums))
        res = 0
        
        hashMap = {}
        css = 0
        l = 0
        for r in range(len(nums)):
            if nums[r] in hashMap:
                hashMap[nums[r]] += 1
            else:
                hashMap[nums[r]] = 1

            if hashMap[nums[r]] == 1:
                css += 1
                
            while css == s:
                res += len(nums) - r
                hashMap[nums[l]] -= 1
                if hashMap[nums[l]] == 0:
                    css -= 1
                l += 1
        return res
                    
                        
    



result = Solution()
result.countCompleteSubarrays(nums = [5,5,5,5])
result.countCompleteSubarrays(nums = [1,3,1,2,2])
result.countCompleteSubarrays([1731,1507,1731,390,618,1588,39,1727,668,1588,761,567,1404,1588,574,331,1115,1031,481,72,481,789,1588,1204,1623,877,1988,1964,1156,148,605,441,1588,659,659,1988,1008,668,302,1608,1194,148,830,1019,1731,1623,351,627,756,1608,1759,35,1073,992,659,898,1381,1575,423,907,756,511,423,169,39,913,1844,555,428,801,1745,1812,627,1364,148,1831,769,408,1215,659,148,589,292,570,1331,1484,331,1336,1203,7,1342,175,1060,663,1284,121,1411,195,673,1591,572,1438,217,1717,1113,1588,1696,597,850,1992,1929,1331,734,605,1943,1675,680,284,1812,1659,659,312,1869,911,240,207,1913,1088,1383,1588,883,741,1727,359,506,627,1707,1178,397,418,222,1903,39,61,1623,1467,1588,1958,493,530,791,294,659,309,1276,1812,390,197,331,137,626,217,1739,262,627,1911,720,39,900,423,1312,2000,883,985,903,324,602,1241,1347,2000,892,1562,1417,222,465,627,507,917,1271,359,632,801,655,401,1860,1477,408,1014,670,1027,465,1549,1087,1383,1844,1429,1911,423,583,224,101,1973,187,1869,1169,1897,1450,1030,336,1897,469,1835,312,1265,1727,1591,220,1896,50,148,1075,1514,9,927,1275,251,1210,1623,278,1544,1532,351,246,836,1479,309,321,418,1608,1707,1453,641,1168,1467,933,1990,1608,1122,1579,477,131,1382,229,1043,421,1722,407,675,541,337,1162,1311,390,272,688,292,1877,350,419,1536,1352,1352,793,462,943,800,391,1203,698,131,1907,465,934,1964,1559,515,2000,1634,160,626,318,470,217,627,802,237,770,1423,1565,130,67,356,216,502,1772,209,1047,639,366,348,397,1766,529,1537,498,1008,128,131,1465,1122,1111,1080,223,1581,1993,1608,744,92,465,391,1209,1588,39,953,1928,850,1001,1674,433,1613,1757,1035,471,493,1900,490,197,359,1312,1752,1711,589,757,725,1031,1657,466,226,372,1074,213,935,1001,1640,220,1970,1805,1214,1202,1072,460,900,867,585,922,187,937,482,670,830,987,1371,416,371,555,419,1343,1239,1378,630,589,541,773,1779,1370,1120,585,1834,254,347,235,665,251,1910,1293,622,31,887,972,900,3,473,716,1460,1927,529,1359,472,945,1284,1748,921,958,1512,934,911,1562,1783,701,324,337,1741,1933,14,5,779,305,749,1408,193,187,192,1163,1608,1859,59,1965,524,543,1248,73,34,1309,1027,216,1901,252,131,1282,1482,1874,1941,518,401,390,682,610,350,498,240,240,235,461,1004,961,1148,1790,476,1360,1043,423,91,566,935,1048,175,39,631,1120,1399,559,469,1545,615,39,1217,123,1073,39,1884,1171,771,907,1381,1403,1331,757,30,702,282,714,911,297,518,1943,1588,455,7,302,463,694,1610,529,1062,1298,1846,1628,193,1345,205,316,1286,39,1834,1290,569,1715,1211,1235,1880,149,1514,639,1104,1371,1397,1363,1276,385,1706,1716,1203,695,1144,1865,337,1037,1192,462,779,1457,512,942,809,976,1029,280,1273,1783,1209,735,521,804,229,529,1623,150,883,1900,192,1768,1764,1998,1123,1312,1932,1454,957,1620,1008,1080,421,534,138,1773,530,859,390,1549,1104,757,1722,770,949,219,850,469,1360,1821,1559,1844,346,53,1766,851,1202,607,87,1514,31,1900,667,598,659,47,957,1470,995,1441,1405,1599,1532,346,1902,1032,521,180,1236,1273,1032,250,1897,1030,1559,166,1268,636,97,1192,1446,1076,672,602,911,1608,1742,1276,742,665,1256,1778,797,102,1861,44,1008,1473,772,414,612,58,838,280,1208,1296,462,1859,351,1291,45,204,850,1115,1867,880,120,339,1398,1124,1623,1867,1526,1511,886,337,1562,1699,867,117,1164,1724,1811,1742,32,1127,978,1156,507,216,1844,1627,1670,783,117,900,18,82,1350,419,509,228,1274,1404,1801,1426,1368,875,1184,903,1556,1835,1825,1902,1527,285,512,1096,1710,1668,716,878,1937,1577,1968,205,910,1157,460,337,1777,744,358,763,900,1723,1734,695,896,1088,326,169,577,1216,1372,401,707,230,797,1473,371,1268,280,1355,1373,20,720,235,1102,1741,285,205,1185,1042,339,659,1873,1030,1324,1001,418,1389,239,52,1334,610,1543,1242,663,1584,1187,1632,1358,1904,1195,399,1867,1083,1368,1677,1830,1355,1192,317,1924,1663,720,1083,784,932,914,987,1494,1416,220,1072,1056,449,1104,105,1927,383,542,133,1532,756,507,1115,423,188,217,1287,381,148,98,876,1933,33,1929,1943,569,1951,1559,1983,574,883,129,1386,82,1083,262,135,1012,1082,453,1062,1291,475,1539,1854,725,450,577,580,1746,1739,1956,1290,1236,1052,1406,242,1513,347,1379,800,602,753,11,498,45,1027,1482,1238,1350,680,872,588,1686,1132,1575,1365,413,1149,1402,1982,894,498,15,989,877,442,313,1486,299,1345,1821,397,1222,302,1453,1941,229])